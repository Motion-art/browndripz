<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Collections - Guaptap Luxury Clothing | Premium Streetwear Collections</title>
    <link rel="stylesheet" href="../css/main.css">
    <style>
        /* Hover effect for craftsmanship videos */
        .craft-video {
            transition: transform 0.35s ease, filter 0.35s ease;
            transform-origin: center center;
            cursor: pointer;
        }
        .craft-video:hover {
            transform: scale(1.05);
            filter: brightness(1.06);
        }
        @media (prefers-reduced-motion: reduce) {
            .craft-video { transition: none; }
        }
        /* Mobile header video: hidden on desktop, shown only on small viewports */
        .mobile-header-video { display: none; }
        .header-bg-img { display: block; }
        @media (max-width: 768px) {
            .mobile-header-video { display: block; position: absolute; inset: 0; width: 100%; height: 100%; object-fit: cover; z-index: 0; }
            .header-bg-img { display: none; }
        }
        /* Loading states */
        .loading-spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3498db;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 2s linear infinite;
            margin: 20px auto;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .hidden { display: none; }
    </style>
    <meta name="description" content="Explore our curated streetwear drops. From core essentials to limited-edition collaborations, discover pieces made for city life and street style.">
    <script type="module" src="https://static.rocket.new/rocket-web.js?_cfg=https%3A%2F%2Fguaptap7699back.builtwithrocket.new&_be=https%3A%2F%2Fapplication.rocket.new&_v=0.1.9"></script>
    <script type="module" src="https://static.rocket.new/rocket-shot.js?v=0.0.1"></script>
</head>
<body class="bg-background font-inter">
    <!-- Header Navigation -->
    <header id="main-header" class="fixed top-0 left-0 right-0 z-50 transition-all duration-400 transition-premium">
        <div class="bg-primary/90 backdrop-blur-md border-b border-secondary/20">
            <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
                <div class="flex items-center justify-between h-16">
                    <!-- Logo -->
                    <div class="flex-shrink-0">
                        <a href="../index.html" class="flex items-center space-x-2 text-white">
                            <img src="../assets/guaptap.jpeg" alt="GUAPTAP Logo" class="w-8 h-8 rounded-full object-cover">
                            <span class="font-playfair font-bold text-xl tracking-wider">GUAPTAP</span>
                        </a>
                    </div>
                    
                    <!-- Desktop Navigation -->
                    <nav class="hidden md:flex items-center space-x-8">
                        <a href="collection_overview.html" class="text-accent font-inter font-medium">Collections</a>
                        <a href="style_guide.html" class="text-white hover:text-accent transition-colors duration-300 font-inter font-medium">Style Guide</a>
                    </nav>
                    
                    <!-- Search and Account -->
                    <div class="flex items-center space-x-4">
                        <a href="account_dashboard.html" class="text-white hover:text-accent transition-colors duration-300">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"></path>
                            </svg>
                        </a>
                        <a href="checkout.html" class="text-white hover:text-accent transition-colors duration-300 relative">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4m0 0L7 13m0 0l-2.5 5M7 13l2.5 5m6-5v6a2 2 0 01-2 2H9a2 2 0 01-2-2v-6m8 0V9a2 2 0 00-2-2H9a2 2 0 00-2 2v4.01"></path>
                            </svg>
                            <span class="absolute -top-2 -right-2 bg-accent text-white text-xs rounded-full w-4 h-4 flex items-center justify-center">2</span>
                        </a>
                        
                        <!-- Mobile Menu Button -->
                        <button class="md:hidden text-white">
                            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                            </svg>
                        </button>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Search removed from header -->
    </header>

    <!-- Combined Breadcrumb & Page Header -->
    <section class="pt-24 pb-16 bg-primary text-white relative overflow-hidden">
        <!-- Mobile-only header video (swaps in at <=768px) -->
        <video class="mobile-header-video" autoplay muted loop playsinline preload="metadata" poster="../assets/guap_collections.jpeg">
            <source src="../assets/collection_guap.mp4" type="video/mp4">
            <!-- Fallback will be the background image below on non-supporting browsers -->
        </video>

        <!-- Desktop header video (shown only on desktop/web) -->
        <div class="absolute inset-0 header-bg-img" style="opacity:0.30;">
            <video autoplay muted loop playsinline preload="metadata" poster="../assets/guap_collections.jpeg" class="w-full h-full object-cover">
                <source src="../assets/guap_header.mp4" type="video/mp4">
                <!-- Fallback image if video isn't supported -->
                <img src="https://images.unsplash.com/photo-1651981265769-ab0e2311e781" 
                     alt="Design studio showcasing streetwear sampling and fabric selection for urban apparel" 
                     class="w-full h-full object-cover">
            </video>
        </div>

        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10">
            <div class="text-center max-w-4xl mx-auto">
                <!-- Breadcrumb -->
                <nav class="flex items-center justify-center space-x-3 text-base tracking-wide font-inter mb-8">
                    <a href="../index.html" class="text-white/80 hover:text-accent transition-colors duration-300">Home</a>
                    <svg class="w-5 h-5 text-white/60" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                    </svg>
                    <span class="text-accent font-medium">Collections</span>
                </nav>

                <!-- Main Heading -->
                <h1 class="font-playfair font-bold text-5xl md:text-6xl lg:text-7xl mb-6 tracking-wide leading-tight">
                    Curated Collections
                </h1>

                <!-- Description -->
                <p class="font-inter text-lg md:text-xl opacity-90 leading-relaxed max-w-2xl mx-auto mb-8">
                    Discover our curated streetwear collections where heritage techniques meet contemporary urban design. Each drop blends quality materials with city-ready style.
                </p>
            </div>
        </div>
    </section>

    <!-- Loading State -->
    <div id="loading-state" class="py-12">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
            <div class="loading-spinner"></div>
            <p class="mt-4 text-text-secondary">Loading collections...</p>
        </div>
    </div>

    <!-- Error State -->
    <div id="error-state" class="py-12 hidden">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center">
            <div class="error-state bg-red-50 p-8 rounded-lg">
                <h3 class="text-xl font-semibold text-red-800 mb-2">Unable to Load Products</h3>
                <p class="text-red-600 mb-4" id="error-message">We're having trouble loading the collections.</p>
                <button id="retry-btn" class="btn-primary">Try Again</button>
            </div>
        </div>
    </div>

    <!-- Main Content -->
    <section id="main-content" class="py-12 bg-background hidden">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex flex-col lg:flex-row gap-8">
                <!-- Filters Dropdown -->
                <aside class="lg:w-80 flex-shrink-0">
                    <div class="bg-white shadow-card p-6 sticky top-24">
                        <div class="flex items-center justify-between mb-6">
                            <h3 class="font-playfair font-semibold text-xl text-primary">Filters</h3>
                            <button id="reset-filters" class="text-accent hover:text-accent/80 font-inter text-sm font-medium">
                                Reset All
                            </button>
                        </div>
                        
                        <!-- Collection Type Filter -->
                        <div class="relative mb-4">
                            <button id="collection-type-trigger" class="w-full flex items-center justify-between p-4 border border-secondary hover:border-accent transition-colors duration-300 font-inter">
                                <span class="text-primary">Collection Type</span>
                                <svg class="w-5 h-5 transform transition-transform duration-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                                </svg>
                            </button>
                            <div id="collection-type-dropdown" class="hidden absolute z-50 w-full mt-2 bg-white border border-secondary shadow-premium">
                                <div class="p-4 space-y-3">
                                    <label class="flex items-center cursor-pointer">
                                        <input type="checkbox" class="sr-only filter-checkbox" data-filter="seasonal">
                                        <div class="w-4 h-4 border-2 border-secondary mr-3 flex items-center justify-center">
                                            <svg class="w-3 h-3 text-accent opacity-0 transition-opacity duration-200" fill="currentColor" viewBox="0 0 20 20">
                                                <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                                            </svg>
                                        </div>
                                        <span class="font-inter text-text-primary">Seasonal Collections</span>
                                    </label>
                                    <label class="flex items-center cursor-pointer">
                                        <input type="checkbox" class="sr-only filter-checkbox" data-filter="core">
                                        <div class="w-4 h-4 border-2 border-secondary mr-3 flex items-center justify-center">
                                            <svg class="w-3 h-3 text-accent opacity-0 transition-opacity duration-200" fill="currentColor" viewBox="0 0 20 20">
                                                <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                                            </svg>
                                        </div>
                                        <span class="font-inter text-text-primary">Core Essentials</span>
                                    </label>
                                    <label class="flex items-center cursor-pointer">
                                        <input type="checkbox" class="sr-only filter-checkbox" data-filter="limited">
                                        <div class="w-4 h-4 border-2 border-secondary mr-3 flex items-center justify-center">
                                            <svg class="w-3 h-3 text-accent opacity-0 transition-opacity duration-200" fill="currentColor" viewBox="0 0 20 20">
                                                <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                                            </svg>
                                        </div>
                                        <span class="font-inter text-text-primary">Limited Editions</span>
                                    </label>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Material Filter -->
                        <div class="relative mb-4">
                            <button id="material-trigger" class="w-full flex items-center justify-between p-4 border border-secondary hover:border-accent transition-colors duration-300 font-inter">
                                <span class="text-primary">Material</span>
                                <svg class="w-5 h-5 transform transition-transform duration-300" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7"></path>
                                </svg>
                            </button>
                            <div id="material-dropdown" class="hidden absolute z-50 w-full mt-2 bg-white border border-secondary shadow-premium">
                                <div class="p-4 space-y-3">
                                    <label class="flex items-center cursor-pointer">
                                        <input type="checkbox" class="sr-only filter-checkbox" data-filter="cotton">
                                        <div class="w-4 h-4 border-2 border-secondary mr-3 flex items-center justify-center">
                                            <svg class="w-3 h-3 text-accent opacity-0 transition-opacity duration-200" fill="currentColor" viewBox="0 0 20 20">
                                                <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                                            </svg>
                                        </div>
                                        <span class="font-inter text-text-primary">Organic Cotton</span>
                                    </label>
                                    <label class="flex items-center cursor-pointer">
                                        <input type="checkbox" class="sr-only filter-checkbox" data-filter="wool">
                                        <div class="w-4 h-4 border-2 border-secondary mr-3 flex items-center justify-center">
                                            <svg class="w-3 h-3 text-accent opacity-0 transition-opacity duration-200" fill="currentColor" viewBox="0 0 20 20">
                                                <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                                            </svg>
                                        </div>
                                        <span class="font-inter text-text-primary">Premium Wool</span>
                                    </label>
                                </div>
                            </div>
                        </div>
                    </div>
                </aside>

                <!-- Collections Grid -->
                <main class="flex-1">
                    <!-- Sort and View Options -->
                    <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center mb-8 gap-4">
                        <div class="flex items-center space-x-4">
                            <span class="font-inter text-text-secondary" id="product-count">Loading products...</span>
                        </div>
                        <div class="flex items-center space-x-4">
                            <select class="bg-white border border-secondary px-4 py-2 font-inter text-text-primary focus:outline-none focus:border-accent">
                                <option>Sort by: Featured</option>
                                <option>Price: Low to High</option>
                                <option>Price: High to Low</option>
                                <option>Newest First</option>
                            </select>
                        </div>
                    </div>

                    <!-- Collection Cards Grid -->
                    <div id="shopify-collection-grid" class="grid grid-cols-2 sm:grid-cols-2 md:grid-cols-2 lg:grid-cols-3 gap-6">
                        <!-- Products will be injected here -->
                    </div>

                    <!-- Load More Button -->
                    <div class="text-center mt-12">
                        <button class="btn-primary hover:bg-secondary transform hover:scale-105 transition-all duration-300">
                            Load More Collections
                        </button>
                    </div>
                </main>
            </div>
        </div>
    </section>

    <!-- Craftsmanship Story Section -->
    <section class="py-20 bg-primary text-white relative overflow-hidden">
        <div class="absolute inset-0" style="opacity:0.06;">
            <video autoplay muted loop playsinline poster="../assets/guap_collections.jpeg" class="w-full h-full object-cover">
                <source src="../assets/guaptap.mp4" type="video/mp4">
                <img src="https://images.unsplash.com/photo-1671707976056-7517e7bec705" 
                     alt="Master craftspeople working on Guaptap streetwear in a studio showcasing artisanal expertise" 
                     class="w-full h-full object-cover">
            </video>
        </div>

        <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10">
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 items-center">
                <div>
                    <h2 class="font-playfair font-semibold text-4xl md:text-5xl mb-6">
                        The Art of Craftsmanship
                    </h2>
                    <p class="font-inter text-lg opacity-90 leading-relaxed mb-8">
                        Every collection begins with a story. Our artisans spend months perfecting each design, sourcing the finest materials from heritage mills across Europe, and employing techniques passed down through generations.
                    </p>
                    <div class="space-y-4 mb-8">
                        <div class="flex items-center">
                            <svg class="w-6 h-6 text-accent mr-4" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                            </svg>
                            <span class="font-inter">Heritage techniques from master craftsmen</span>
                        </div>
                        <div class="flex items-center">
                            <svg class="w-6 h-6 text-accent mr-4" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                            </svg>
                            <span class="font-inter">Premium materials sourced globally</span>
                        </div>
                        <div class="flex items-center">
                            <svg class="w-6 h-6 text-accent mr-4" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd"></path>
                            </svg>
                            <span class="font-inter">Sustainable and ethical production</span>
                        </div>
                    </div>
                    <a href="javascript:void(0)" class="btn-accent hover:bg-accent/80 transform hover:scale-105 transition-all duration-300">
                        Explore Our Process
                    </a>
                </div>
                <div class="grid grid-cols-2 gap-4">
                    <div class="space-y-4">
                        <video autoplay muted loop playsinline class="w-full h-40 object-cover shadow-card craft-video">
                            <source src="../assets/guap_show1.mp4" type="video/mp4">
                            <img src="https://images.unsplash.com/photo-1501087063833-3773ee886f20" 
                                 alt="Close-up of skilled hands crafting premium leather goods with traditional tools and techniques" 
                                 class="w-full h-40 object-cover shadow-card">
                        </video>
                        <video autoplay muted loop playsinline class="w-full h-32 object-cover shadow-card craft-video">
                            <source src="../assets/guap_show2.mp4" type="video/mp4">
                            <img src="https://images.pixabay.com/photo-2016/11/29/09/00/denim-1868364_1280.jpg" 
                                 alt="Premium fabric selection showing textiles and materials used in Guaptap streetwear" 
                                 class="w-full h-32 object-cover shadow-card">
                        </video>
                    </div>
                    <div class="space-y-4 pt-8">
                        <video autoplay muted loop playsinline class="w-full h-32 object-cover shadow-card craft-video">
                            <source src="../assets/guap_show3.mp4" type="video/mp4">
                            <img src="https://images.unsplash.com/photo-1647421925189-7aae670378ff" 
                                 alt="Artisan tailor working on bespoke suit construction in traditional workshop environment" 
                                 class="w-full h-32 object-cover shadow-card">
                        </video>
                        <video autoplay muted loop playsinline class="w-full h-40 object-cover shadow-card craft-video">
                            <source src="../assets/guap_header.mp4" type="video/mp4">
                            <img src="https://images.pexels.com/photos/1043474/pexels-photo-1043474.jpeg?auto=compress&cs=tinysrgb&w=2940" 
                                 alt="Detailed view of precision stitching and construction techniques used in Guaptap streetwear" 
                                 class="w-full h-40 object-cover shadow-card">
                        </video>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-primary text-white py-16">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-8">
                <!-- Brand -->
                <div class="col-span-1 md:col-span-2">
                    <h3 class="font-playfair font-bold text-2xl mb-4">GUAPTAP</h3>
                    <p class="font-inter text-white/80 mb-6 max-w-md">
                        Crafting premium streetwear for the modern urban individual. Where heritage meets street innovation in every stitch.
                    </p>
                </div>
                
                <!-- Quick Links -->
                <div>
                    <h4 class="font-inter font-semibold text-lg mb-4">Quick Links</h4>
                    <ul class="space-y-2">
                        <li><a href="collection_overview.html" class="font-inter text-white/80 hover:text-white transition-colors duration-300">Collections</a></li>
                        <li><a href="style_guide.html" class="font-inter text-white/80 hover:text-white transition-colors duration-300">Style Guide</a></li>
                        <li><a href="javascript:void(0)" class="font-inter text-white/80 hover:text-white transition-colors duration-300">About Us</a></li>
                    </ul>
                </div>
                
                <!-- Customer Service -->
                <div>
                    <h4 class="font-inter font-semibold text-lg mb-4">Customer Service</h4>
                    <ul class="space-y-2">
                        <li><a href="javascript:void(0)" class="font-inter text-white/80 hover:text-white transition-colors duration-300">Size Guide</a></li>
                        <li><a href="javascript:void(0)" class="font-inter text-white/80 hover:text-white transition-colors duration-300">Returns</a></li>
                        <li><a href="javascript:void(0)" class="font-inter text-white/80 hover:text-white transition-colors duration-300">Shipping</a></li>
                    </ul>
                </div>
            </div>
            
            <div class="border-t border-white/20 mt-12 pt-8 text-center">
                <p class="font-inter text-white/60">
                    Â© 2025 Guaptap Luxury Clothing. All Rights Reserved.
                </p>
            </div>
        </div>
    </footer>

    <script>
        // Header scroll behavior
        let lastScrollTop = 0;
        const header = document.getElementById('main-header');
        
        window.addEventListener('scroll', function() {
            let scrollTop = window.pageYOffset || document.documentElement.scrollTop;
            
            if (scrollTop > lastScrollTop && scrollTop > 100) {
                header.style.transform = 'translateY(-100%)';
            } else {
                header.style.transform = 'translateY(0)';
            }
            
            if (scrollTop > 50) {
                header.classList.add('backdrop-blur-md');
            } else {
                header.classList.remove('backdrop-blur-md');
            }
            
            lastScrollTop = scrollTop;
        });

        // Filter functionality
        const filterCheckboxes = document.querySelectorAll('.filter-checkbox');
        const resetFilters = document.getElementById('reset-filters');
        
        // Dropdown triggers
        const dropdownTriggers = {
            'collection-type': document.getElementById('collection-type-trigger'),
            'material': document.getElementById('material-trigger')
        };

        // Dropdown contents
        const dropdowns = {
            'collection-type': document.getElementById('collection-type-dropdown'),
            'material': document.getElementById('material-dropdown')
        };

        // Handle dropdown toggles
        Object.keys(dropdownTriggers).forEach(key => {
            const trigger = dropdownTriggers[key];
            const dropdown = dropdowns[key];
            const arrow = trigger.querySelector('svg');
            
            trigger.addEventListener('click', function() {
                // Close other dropdowns
                Object.keys(dropdowns).forEach(k => {
                    if (k !== key) {
                        dropdowns[k].classList.add('hidden');
                        dropdownTriggers[k].querySelector('svg').classList.remove('rotate-180');
                    }
                });

                // Toggle current dropdown
                dropdown.classList.toggle('hidden');
                arrow.classList.toggle('rotate-180');
            });
        });

        // Close dropdowns when clicking outside
        document.addEventListener('click', function(e) {
            if (!e.target.closest('.relative')) {
                Object.values(dropdowns).forEach(dropdown => {
                    dropdown.classList.add('hidden');
                });
                Object.values(dropdownTriggers).forEach(trigger => {
                    trigger.querySelector('svg').classList.remove('rotate-180');
                });
            }
        });

        // Reset filters
        resetFilters.addEventListener('click', function() {
            filterCheckboxes.forEach(checkbox => {
                checkbox.checked = false;
                const checkmark = checkbox.nextElementSibling.querySelector('svg');
                checkmark.classList.add('opacity-0');
                checkbox.nextElementSibling.classList.remove('border-accent');
            });
        });

        // Checkbox filter handling
        filterCheckboxes.forEach(checkbox => {
            checkbox.addEventListener('change', function() {
                const checkmark = this.nextElementSibling.querySelector('svg');
                if (this.checked) {
                    checkmark.classList.remove('opacity-0');
                    this.nextElementSibling.classList.add('border-accent');
                } else {
                    checkmark.classList.add('opacity-0');
                    this.nextElementSibling.classList.remove('border-accent');
                }
            });
        });

        // Smooth scroll for anchor links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });
    </script>

    <!-- Shopify Integration -->
    <script type="module">
        // DOM elements for loading states
        const loadingState = document.getElementById('loading-state');
        const errorState = document.getElementById('error-state');
        const mainContent = document.getElementById('main-content');
        const retryBtn = document.getElementById('retry-btn');
        const errorMessage = document.getElementById('error-message');
        const productCount = document.getElementById('product-count');
        const collectionGrid = document.getElementById('shopify-collection-grid');

        function showLoading() {
            loadingState.classList.remove('hidden');
            errorState.classList.add('hidden');
            mainContent.classList.add('hidden');
        }

        function showError(message) {
            loadingState.classList.add('hidden');
            errorState.classList.remove('hidden');
            mainContent.classList.add('hidden');
            errorMessage.textContent = message;
        }

        function showContent() {
            loadingState.classList.add('hidden');
            errorState.classList.add('hidden');
            mainContent.classList.remove('hidden');
        }

        async function loadProducts() {
            showLoading();
            
            try {
                // Load Shopify configuration and client
                const { SHOP, API_VERSION, STOREFRONT_TOKEN } = await import('../config/shopify-config.js');
                const { initShopify, getProducts, renderProductCard, addToRemoteCart, cartAPI, getCheckoutUrlForStoredCart } = await import('../src/js/shopify-client.js');

                // Initialize Shopify
                initShopify({ shop: SHOP, apiVersion: API_VERSION, token: STOREFRONT_TOKEN });

                // Fetch products
                const products = await getProducts(12);
                
                if (!products || products.length === 0) {
                    showError('No products found in your Shopify store.');
                    return;
                }

                // Clear existing content
                collectionGrid.innerHTML = '';

                // Render products
                products.forEach(product => {
                    const card = renderProductCard(product);
                    
                    // CORRECTED CLICK HANDLER - This is the key fix!
                    card.addEventListener('click', (e) => {
                        // Prevent the click from bubbling to parent elements
                        e.stopPropagation();
                        
                        console.log('Product clicked:', product.handle);
                        console.log('Product title:', product.title);
                        
                        // Navigate to new minimal product details page with handle parameter
                        window.location.href = `product_details.html?handle=${encodeURIComponent(product.handle)}`;
                    });

                    // Add to cart button functionality
                    const addToCartBtn = card.querySelector('.add-to-cart-btn');
                    if (addToCartBtn) {
                        addToCartBtn.addEventListener('click', async (e) => {
                            e.stopPropagation(); // Prevent card click
                            e.preventDefault();
                            
                            addToCartBtn.disabled = true;
                            addToCartBtn.textContent = 'Adding...';
                            
                            try {
                                const variantId = card.dataset.variantId || product.variants?.[0]?.id;
                                if (variantId) {
                                    // Add the item to the remote Shopify Cart (Cart API)
                                    const remoteCart = await addToRemoteCart(variantId, 1);
                                    // Update local UI cart for instant feedback
                                    const price = card.querySelector('span.font-inter.text-sm')?.textContent.replace('$','') || '';
                                    const title = product.title || card.dataset.handle || '';
                                    cartAPI.addItem(variantId, title, price, 1);
                                    // Optionally redirect to checkout URL if you want to go straight to checkout
                                    // const checkoutUrl = await getCheckoutUrlForStoredCart();
                                    // if (checkoutUrl) window.location.href = checkoutUrl;
                                    // Simple acknowledgement for now
                                    alert('Added to cart');
                                } else {
                                    alert('No variant available for this product');
                                }
                            } catch (err) {
                                console.error('Add to Cart error (remote):', err);
                                alert('Error adding to cart');
                            } finally {
                                addToCartBtn.disabled = false;
                                addToCartBtn.textContent = 'Add to Cart';
                            }
                        });
                    }

                    collectionGrid.appendChild(card);
                });

                // Update product count
                productCount.textContent = `Showing ${products.length} products`;
                
                showContent();

            } catch (error) {
                console.error('Failed to load products:', error);
                showError('Failed to load products from Shopify. Please check your configuration and try again.');
            }
        }

        // Initialize the page
        document.addEventListener('DOMContentLoaded', function() {
            // Set up retry button
            retryBtn.addEventListener('click', loadProducts);
            
            // Load products initially
            loadProducts();
        });

        // GPU optimization for header
        window.addEventListener('load', () => {
            if (header) {
                header.style.transform = 'translateZ(0)';
                header.style.willChange = 'transform';
            }
        });
    </script>
<!-- Debug Script - Add this before closing body tag -->
<script>
    // Debug click events on the entire page
    document.addEventListener('click', function(e) {
        const card = e.target.closest('.collection-card');
        if (card) {
            console.log('ðŸ”„ Global click caught on card:', card.dataset.handle);
            console.log('ðŸŽ¯ Target element:', e.target.tagName, e.target.className);
        }
    });

    // Test URL generation
    function testURLGeneration() {
        const testHandle = 'test-product-handle';
        const urls = [
            `product_detail.html?handle=${testHandle}`,
            `./product_detail.html?handle=${testHandle}`,
            `../pages/product_detail.html?handle=${testHandle}`,
            `/pages/product_detail.html?handle=${testHandle}`
        ];
        
        console.log('ðŸ§ª Testing URL formats:');
        urls.forEach(url => console.log('   ', url));
    }

    // Run test on load
    setTimeout(testURLGeneration, 1000);
</script>
<!-- Floating Cart UI -->
<style>
    #cart-float-btn { position: fixed; left: 16px; bottom: 16px; z-index: 60; background: var(--color-accent); color: #fff; width:48px; height:48px; border-radius:9999px; display:flex; align-items:center; justify-content:center; box-shadow:0 6px 18px rgba(0,0,0,.12); cursor:pointer }
    #cart-float-btn .count { position:absolute; top:-6px; right:-6px; background:#000; color:#fff; width:20px; height:20px; border-radius:9999px; display:flex; align-items:center; justify-content:center; font-size:12px }
    #cart-drawer { position: fixed; left: 16px; bottom: 80px; z-index: 70; width: 320px; max-width: calc(100% - 32px); background: #fff; border-radius: 12px; box-shadow: 0 12px 30px rgba(0,0,0,.12); padding: 12px; display: none; }
    #cart-drawer h4 { margin:0 0 8px 0; }
    #cart-drawer .cart-item { display:flex; gap:8px; align-items:center; padding:8px 0; border-bottom:1px dashed #eee }
    #cart-drawer .cart-item img { width:48px; height:48px; object-fit:cover; border-radius:6px }
    #cart-drawer .cart-actions { display:flex; justify-content:space-between; align-items:center; margin-top:12px }
    @media (max-width:420px){ #cart-drawer { width: calc(100% - 32px); left: 16px; right:16px } }
</style>

<div id="cart-float-btn" title="View cart">
    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"><path d="M6 6h15l-1.5 9h-13z"></path><circle cx="10" cy="20" r="1"></circle><circle cx="18" cy="20" r="1"></circle></svg>
    <div class="count" id="cart-count">0</div>
</div>

<div id="cart-drawer" aria-hidden="true">
    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:8px">
        <h4>Your Cart</h4>
        <button id="close-cart-btn" style="background:none;border:none;font-size:16px;cursor:pointer">âœ•</button>
    </div>
    <div id="cart-items" style="max-height:260px;overflow:auto"></div>
    <div class="cart-actions">
        <div><strong>Total:</strong> $<span id="cart-total">0.00</span></div>
        <div>
            <button id="checkout-btn" class="btn-primary" style="padding:.5rem 1rem;">Checkout</button>
        </div>
    </div>
</div>

<script type="module">
    // Floating cart behaviour: renders local cartAPI and assists checkout via Storefront Cart API
    document.addEventListener('DOMContentLoaded', async () => {
        const btn = document.getElementById('cart-float-btn');
        const drawer = document.getElementById('cart-drawer');
        const closeBtn = document.getElementById('close-cart-btn');
        const cartItemsRoot = document.getElementById('cart-items');
        const cartCount = document.getElementById('cart-count');
        const cartTotalEl = document.getElementById('cart-total');
        const checkoutBtn = document.getElementById('checkout-btn');

        // Import shopify client and ensure init
        const { SHOP, API_VERSION, STOREFRONT_TOKEN } = await import('../config/shopify-config.js');
        const { initShopify, cartAPI, getCheckoutUrlForStoredCart, getRemoteCart } = await import('../src/js/shopify-client.js');
        try { initShopify({ shop: SHOP, apiVersion: API_VERSION, token: STOREFRONT_TOKEN }); } catch (e) { /* ignore if already */ }

        function renderCart() {
            const items = cartAPI.getCart();
            cartItemsRoot.innerHTML = items.length ? items.map(i => `
                <div class="cart-item" data-variant="${i.variantId}">
                    <img src="https://via.placeholder.com/80x80?text=Item" alt="${escapeHtml(i.title || 'item')}"/>
                    <div style="flex:1">
                        <div style="font-weight:600;font-size:14px">${escapeHtml(i.title || '')}</div>
                        <div style="font-size:12px;color:#666">$${i.price} Ã— ${i.quantity}</div>
                    </div>
                    <button class="remove-item" style="background:none;border:none;color:#c00;cursor:pointer">Remove</button>
                </div>
            `).join('') : '<div class="text-sm text-text-secondary">Your cart is empty</div>';

            // attach remove handlers
            cartItemsRoot.querySelectorAll('.remove-item').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const card = e.target.closest('.cart-item');
                    const variant = card?.dataset?.variant;
                    if (variant) {
                        cartAPI.removeItem(variant);
                        renderCart();
                    }
                });
            });

            // update count & total
            cartCount.textContent = cartAPI.getCart().length;
            cartTotalEl.textContent = Number(cartAPI.getTotal()).toFixed(2);
        }

        // simple escaping helper
        function escapeHtml(str) { if (!str) return ''; return String(str).replace(/[&<>'"]/g, (s)=>({ '&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":"&#39;" })[s]); }

        // toggle drawer
        btn.addEventListener('click', () => {
            if (drawer.style.display === 'none' || drawer.style.display === '') {
                drawer.style.display = 'block';
                drawer.setAttribute('aria-hidden','false');
            } else {
                drawer.style.display = 'none';
                drawer.setAttribute('aria-hidden','true');
            }
        });
        closeBtn.addEventListener('click', () => { drawer.style.display = 'none'; drawer.setAttribute('aria-hidden','true'); });

        // checkout flow
        checkoutBtn.addEventListener('click', async () => {
            // Try to redirect to Storefront checkout for stored cart
            const url = await getCheckoutUrlForStoredCart();
            if (url) {
                window.location.href = url;
                return;
            }

            // If no remote cart yet, instruct user
            if (cartAPI.getCart().length === 0) {
                alert('Your cart is empty');
                return;
            }
            alert('No remote cart detected yet. Proceed to add an item (Add to Cart) to create a remote cart, then checkout.');
        });

        // Poll for changes to the local cart (simple approach)
        let prevCount = -1;
        setInterval(() => {
            const c = cartAPI.getCart();
            if (c.length !== prevCount) {
                prevCount = c.length;
                renderCart();
            }
        }, 400);

        // initial render
        renderCart();
    });
</script>
</body>
</html>